# WARNING - Generated by {fusen} from /dev/flat_compile_qmd_course.Rmd: do not edit by hand

test_that("extract_html_slides works", {
  # create temp dir
  temp_dir <- tempfile(pattern = "template")
  dir.create(temp_dir)
  
  # copy qmd in tmp
  nq1h_path <- system.file(package = "nq1h")

  files_to_copy <- c(
    file.path(
      nq1h_path,
      c("_extensions",
        "courses",
        "_quarto.yaml",
        "_quarto-render.yml")
    )
  )
  
  file.copy(
    from = files_to_copy,
    to = temp_dir,
    recursive = TRUE
  )
  
  # render all course qmd in quarto project with default profile
  # remove as_job to not run as background jobs
  quarto::quarto_render(
    input = temp_dir,
    as_job = FALSE
    )
  
  # list created html
  htmls <- list.files(
    path = temp_dir,
    pattern = "qmd[0-9]_for_test\\.html$",
    recursive = TRUE,
    full.names = TRUE
  )
  
  # test with three html files in order 1-2-3
  html_slide_content <- extract_html_slides(
    vec_html_path = htmls
    )
  
  expect_equal(
    object = html_slide_content,
    expected = structure(
      "<section id=\"title-slide-1\" data-background-image=\"../../_extensions/ThinkR-open/thinkridentity/background.png\" class=\"quarto-title-block center\"><h1 class=\"title\">Premier Chapitre</h1>\n  <p class=\"subtitle\">alpha</p>\n\n<div class=\"quarto-title-authors\">\n</div>\n\n</section>\n<section id=\"slide-1\" class=\"slide level2\"><h2>Slide 1</h2>\n<p>An example code chunk</p>\n<div class=\"cell\">\n<div class=\"sourceCode cell-code\" id=\"cb1\"><pre class=\"sourceCode numberSource r number-lines code-with-copy\"><code class=\"sourceCode r\"><span id=\"cb1-1\"><a href=\"#cb1-1\"></a><span class=\"dv\">8</span> <span class=\"sc\">*</span> <span class=\"dv\">8</span></span></code><button title=\"Copy to Clipboard\" class=\"code-copy-button\"><i class=\"bi\"></i></button></pre></div>\n<div class=\"cell-output cell-output-stdout\">\n<pre><code>[1] 64</code></pre>\n</div>\n</div>\n</section>\n<section id=\"slide-1-1\" class=\"slide level2\"><h2>Slide 1</h2>\n<p>{dplyr} image</p>\n<p><img data-src=\"img/logo_1.png\"></p>\n<p><img src=\"../../_extensions/ThinkR-open/thinkridentity/logo.png\" class=\"slide-logo\"></p>\n<div class=\"footer footer-default\">\n<p><strong><i class=\"las la-book\"></i> Premier Chapitre</strong> | Retrouvez nous sur <a href=\"https://thinkr.fr\" class=\"uri\">https://thinkr.fr</a></p>\n</div>\n</section>\n<section id=\"title-slide-2\" data-background-image=\"../../_extensions/ThinkR-open/thinkridentity/background.png\" class=\"quarto-title-block center\"><h1 class=\"title\">Deuxième Chapitre</h1>\n  <p class=\"subtitle\">omega</p>\n\n<div class=\"quarto-title-authors\">\n</div>\n\n</section>\n<section id=\"slide-2\" class=\"slide level2\"><h2>Slide 2</h2>\n<p>Texte 2</p>\n<aside class=\"notes\"><p>This is a speaker note, it is only visible in the speaker view.</p>\n<style type=\"text/css\">\n        span.MJX_Assistive_MathML {\n          position:absolute!important;\n          clip: rect(1px, 1px, 1px, 1px);\n          padding: 1px 0 0 0!important;\n          border: 0!important;\n          height: 1px!important;\n          width: 1px!important;\n          overflow: hidden!important;\n          display:block!important;\n      }</style></aside></section>\n<section id=\"slide-2-1\" class=\"slide level2\"><h2>Slide 2</h2>\n<p>{tidyr} image</p>\n<p><img data-src=\"img/logo_2.png\"></p>\n<p><img src=\"../../_extensions/ThinkR-open/thinkridentity/logo.png\" class=\"slide-logo\"></p>\n<div class=\"footer footer-default\">\n<p><strong><i class=\"las la-book\"></i> Deuxième Chapitre</strong> | Retrouvez nous sur <a href=\"https://thinkr.fr\" class=\"uri\">https://thinkr.fr</a></p>\n</div>\n</section>\n<section id=\"title-slide-3\" data-background-image=\"../../_extensions/ThinkR-open/thinkridentity/background.png\" class=\"quarto-title-block center\"><h1 class=\"title\">Troisième Chapitre</h1>\n  <p class=\"subtitle\">youpi</p>\n\n<div class=\"quarto-title-authors\">\n</div>\n\n</section>\n<section id=\"slide-3\" class=\"slide level2\"><h2>Slide 3</h2>\n<p>Texte 3</p>\n</section>\n<section id=\"slide-3-1\" class=\"slide level2\"><h2>Slide 3</h2>\n<p>{ggplot2} image</p>\n<p><img data-src=\"img/logo_1.png\"></p>\n<p><img src=\"../../_extensions/ThinkR-open/thinkridentity/logo.png\" class=\"slide-logo\"></p>\n<div class=\"footer footer-default\">\n<p><strong><i class=\"las la-book\"></i> Troisième Chapitre</strong> | Retrouvez nous sur <a href=\"https://thinkr.fr\" class=\"uri\">https://thinkr.fr</a></p>\n</div>\n</section>",
      html = TRUE,
      class = c("html",
                "character")
    )
  )
  
  # test with three htmls in order 2-1-3
  html_slide_content_reordered <- extract_html_slides(vec_html_path = htmls[c(2, 1, 3)])
  
  expect_equal(
    object = html_slide_content_reordered,
    expected = structure(
      "<section id=\"title-slide-1\" data-background-image=\"../../_extensions/ThinkR-open/thinkridentity/background.png\" class=\"quarto-title-block center\"><h1 class=\"title\">Deuxième Chapitre</h1>\n  <p class=\"subtitle\">omega</p>\n\n<div class=\"quarto-title-authors\">\n</div>\n\n</section>\n<section id=\"slide-2\" class=\"slide level2\"><h2>Slide 2</h2>\n<p>Texte 2</p>\n<aside class=\"notes\"><p>This is a speaker note, it is only visible in the speaker view.</p>\n<style type=\"text/css\">\n        span.MJX_Assistive_MathML {\n          position:absolute!important;\n          clip: rect(1px, 1px, 1px, 1px);\n          padding: 1px 0 0 0!important;\n          border: 0!important;\n          height: 1px!important;\n          width: 1px!important;\n          overflow: hidden!important;\n          display:block!important;\n      }</style></aside></section>\n<section id=\"slide-2-1\" class=\"slide level2\"><h2>Slide 2</h2>\n<p>{tidyr} image</p>\n<p><img data-src=\"img/logo_2.png\"></p>\n<p><img src=\"../../_extensions/ThinkR-open/thinkridentity/logo.png\" class=\"slide-logo\"></p>\n<div class=\"footer footer-default\">\n<p><strong><i class=\"las la-book\"></i> Deuxième Chapitre</strong> | Retrouvez nous sur <a href=\"https://thinkr.fr\" class=\"uri\">https://thinkr.fr</a></p>\n</div>\n</section>\n<section id=\"title-slide-2\" data-background-image=\"../../_extensions/ThinkR-open/thinkridentity/background.png\" class=\"quarto-title-block center\"><h1 class=\"title\">Premier Chapitre</h1>\n  <p class=\"subtitle\">alpha</p>\n\n<div class=\"quarto-title-authors\">\n</div>\n\n</section>\n<section id=\"slide-1\" class=\"slide level2\"><h2>Slide 1</h2>\n<p>An example code chunk</p>\n<div class=\"cell\">\n<div class=\"sourceCode cell-code\" id=\"cb1\"><pre class=\"sourceCode numberSource r number-lines code-with-copy\"><code class=\"sourceCode r\"><span id=\"cb1-1\"><a href=\"#cb1-1\"></a><span class=\"dv\">8</span> <span class=\"sc\">*</span> <span class=\"dv\">8</span></span></code><button title=\"Copy to Clipboard\" class=\"code-copy-button\"><i class=\"bi\"></i></button></pre></div>\n<div class=\"cell-output cell-output-stdout\">\n<pre><code>[1] 64</code></pre>\n</div>\n</div>\n</section>\n<section id=\"slide-1-1\" class=\"slide level2\"><h2>Slide 1</h2>\n<p>{dplyr} image</p>\n<p><img data-src=\"img/logo_1.png\"></p>\n<p><img src=\"../../_extensions/ThinkR-open/thinkridentity/logo.png\" class=\"slide-logo\"></p>\n<div class=\"footer footer-default\">\n<p><strong><i class=\"las la-book\"></i> Premier Chapitre</strong> | Retrouvez nous sur <a href=\"https://thinkr.fr\" class=\"uri\">https://thinkr.fr</a></p>\n</div>\n</section>\n<section id=\"title-slide-3\" data-background-image=\"../../_extensions/ThinkR-open/thinkridentity/background.png\" class=\"quarto-title-block center\"><h1 class=\"title\">Troisième Chapitre</h1>\n  <p class=\"subtitle\">youpi</p>\n\n<div class=\"quarto-title-authors\">\n</div>\n\n</section>\n<section id=\"slide-3\" class=\"slide level2\"><h2>Slide 3</h2>\n<p>Texte 3</p>\n</section>\n<section id=\"slide-3-1\" class=\"slide level2\"><h2>Slide 3</h2>\n<p>{ggplot2} image</p>\n<p><img data-src=\"img/logo_1.png\"></p>\n<p><img src=\"../../_extensions/ThinkR-open/thinkridentity/logo.png\" class=\"slide-logo\"></p>\n<div class=\"footer footer-default\">\n<p><strong><i class=\"las la-book\"></i> Troisième Chapitre</strong> | Retrouvez nous sur <a href=\"https://thinkr.fr\" class=\"uri\">https://thinkr.fr</a></p>\n</div>\n</section>",
      html = TRUE,
      class = c("html",
                "character")
    )
  )
  
  # clean up
  unlink(temp_dir, recursive = TRUE)
})
